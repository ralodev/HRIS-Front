import{_ as w,g as A,a as _,b as l,c as t,d as e,Q as C,e as v,w as b,p as E,u as V,r,o as $,G as f,i as P}from"./index-818cca80.js";import{u as L}from"./usuarioStore-652609a8.js";const M=A({name:"opciones",setup(){const a=L(),o=P();V();const s=r({contrasenaActual:"",contrasenaNueva:"",confirmarNueva:""}),d=r(!1),m=r(!1),p=r(!1),c=r(!1),i=r(!1),h=r(!1),n=r(!1),y=()=>{console.log("pass changed"),s.value.contrasenaNueva!==""&&s.value.contrasenaNueva!==null&&s.value.contrasenaNueva!==void 0?(d.value=/[A-Z]/.test(s.value.contrasenaNueva),m.value=/[a-z]/.test(s.value.contrasenaNueva),p.value=/[0-9]/.test(s.value.contrasenaNueva),c.value=/.*[!#$%&*+-.?@_]/.test(s.value.contrasenaNueva),i.value=/^.{8,20}$/.test(s.value.contrasenaNueva),h.value=d.value&&m.value&&p.value&&c.value&&i.value,n.value=h.value&&s.value.contrasenaNueva===s.value.confirmarNueva&&s.value.contrasenaActual!==""&&s.value.contrasenaActual!==null&&s.value.contrasenaActual!==void 0,n.value?document.getElementById("subPass").classList.remove("p-disabled"):document.getElementById("subPass").classList.add("p-disabled")):(d.value=!1,m.value=!1,p.value=!1,c.value=!1,i.value=!1)},g=async()=>{if(n.value){let u=!1;o.showLoading("Actualizando contraseña"),setTimeout(()=>{u||(o.closeLoading(),o.showErrorAlert("Error","Ocurrió un error inesperado"))},5e3);let k={contrasenaActual:s.value.contrasenaActual,contrasenaNueva:s.value.contrasenaNueva};await a.changePassword(k).then(()=>{o.closeLoading(),u=!0,o.showSuccessAlert("Éxito","Contraseña actualizada correctamente")}).catch(N=>{N.code==="ERR_NETWORK"?o.showErrorAlert("Error","No se pudo conectar con el servidor"):o.showErrorAlert("Error","Ocurrió un error inesperado"),u=!0})}};return $(()=>{document.querySelectorAll('input[type="password"]').forEach(u=>{u.setAttribute("maxlength",20),u.classList.add("w-100")})}),{data:s,tieneMayuscula:d,tieneMinuscula:m,tieneNumero:p,tieneSimbolo:c,passChange:y,tamanoOk:i,cambiarContrasena:g}}}),R={class:"container-lg pt-4 my-3"},B={class:"card shadow-5 border-round-2xl overflow-hidden mx-auto",style:{"max-width":"500px"}},K=e("div",{class:"d-flex card-header py-0 pe-0"},[e("span",{class:"flex text-center"},[e("i",{class:"bi bi-key-fill fw-bold h1 my-0"}),e("span",{class:"fw-bold h4 align-self-center ms-3 my-0"}," Cambiar contraseña ")])],-1),O={class:"card-body table-responsive"},S={class:"grid mb-2"},x={class:"col-12 flex"},z=e("label",null,"Contraseña actual",-1),T=e("label",null,"Escribe una nueva contraseña",-1),U=e("h6",null,"Seguridad de la contraseña",-1),Z=e("p",{class:"mt-2"},"La contraseña debe tener:",-1),q={class:"pl-2 ml-2 mt-0 list-none",style:{"line-height":"1.5"}},D={key:0,class:"pi pi-check-circle text-success"},I={key:1,class:"pi pi-circle"},G={key:0,class:"pi pi-check-circle text-success"},Q={key:1,class:"pi pi-circle"},W={key:0,class:"pi pi-check-circle text-success"},Y={key:1,class:"pi pi-circle"},j={key:0,class:"pi pi-check-circle text-success"},F={key:1,class:"pi pi-circle"},H={key:0,class:"pi pi-check-circle text-success"},J={key:1,class:"pi pi-circle"},X=e("label",null,"Repite tu nueva contraseña",-1),ee=e("div",{class:"col-12 lg:col-6"},null,-1);function ae(a,o,s,d,m,p){const c=_("Password"),i=_("Divider"),h=_("Button");return l(),t("div",R,[e("div",B,[K,e("div",O,[e("div",S,[e("div",x,[e("form",{onSubmit:o[3]||(o[3]=C((...n)=>a.cambiarContrasena&&a.cambiarContrasena(...n),["prevent"]))},[z,v(c,{modelValue:a.data.contrasenaActual,"onUpdate:modelValue":o[0]||(o[0]=n=>a.data.contrasenaActual=n),class:"w-100 mb-3",feedback:!1,toggleMask:"",onKeyup:a.passChange},null,8,["modelValue","onKeyup"]),T,v(c,{modelValue:a.data.contrasenaNueva,"onUpdate:modelValue":o[1]||(o[1]=n=>a.data.contrasenaNueva=n),toggleMask:"",class:"w-100 mb-3",onKeyup:a.passChange,mediumRegex:"^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[!#$%&*+-.?@_]).{6,20}$",strongRegex:"^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[!#$%&*+-.?@_]).{8,20}$",weakLabel:"No cumple con los requisitos mínimos de seguridad",mediumLabel:"Ya casi tienes una contraseña segura"},{header:b(()=>[U]),footer:b(()=>[v(i),Z,e("ul",q,[e("li",null,[a.tieneMayuscula?(l(),t("i",D)):(l(),t("i",I)),f(" Por lo menos una mayúscula ")]),e("li",null,[a.tieneMinuscula?(l(),t("i",G)):(l(),t("i",Q)),f(" Por lo menos una minúscula ")]),e("li",null,[a.tieneNumero?(l(),t("i",W)):(l(),t("i",Y)),f(" Por lo menos un número ")]),e("li",null,[a.tieneSimbolo?(l(),t("i",j)):(l(),t("i",F)),f(" Por lo menos un símbolo (!#$%&*+-.?@_) ")]),e("li",null,[a.tamanoOk?(l(),t("i",H)):(l(),t("i",J)),f(" Entre 8 y 20 caracteres ")])])]),_:1},8,["modelValue","onKeyup","mediumRegex","strongRegex"]),X,v(c,{modelValue:a.data.confirmarNueva,"onUpdate:modelValue":o[2]||(o[2]=n=>a.data.confirmarNueva=n),class:E([[{"p-invalid":a.data.contrasenaNueva!==a.data.confirmarNueva}],"w-100 mb-3"]),feedback:!1,toggleMask:"",onKeyup:a.passChange},null,8,["modelValue","class","onKeyup"]),v(h,{type:"submit",id:"subPass",label:"Cambiar contraseña",icon:"pi pi-check",class:"float-end p-disabled",raised:""})],32)]),ee])])])])}const ne=w(M,[["render",ae]]);export{ne as default};
