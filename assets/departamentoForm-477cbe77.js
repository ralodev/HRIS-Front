import{u as F}from"./departamentoStore-b994d264.js";import{P as A,D as _,g as R,_ as P,r as c,k as L,u as $,o as I,n as G,l as O,a as k,b as i,c as u,d as e,t as d,e as v,q as U,p as N,j as H,w as M,F as W,H as J,i as K,s as Q,S as x,G as S}from"./index-6fc40b30.js";A.use(_,_,_,_);const X=R({name:"DepartamentoForm",watch:{},props:{isEdit:{type:Boolean,default:!1}},components:{DataTable:A},setup(a){const m=c(a.isEdit),D=L(),p=$(),r=F(),g=c(!1),n=c(!1),h=c({}),o=c({}),s=c(null),f=c({}),{showToast:b,showSuccessAlert:T,showConfirmAlert:E,showErrorAlert:C,showLoading:V,closeLoading:q}=K(),j={responsive:!0,autoWidth:!0,dom:"trip",paging:!0,language:Q},z=[{data:null,className:"dt-control",orderable:!1,defaultContent:"",width:"1%",class:""},{data:"numeroTarjeta",title:"Tarjeta",width:"5%",class:""},{data:"rfc",title:"RFC",class:""},{data:"curp",title:"CURP",class:""},{data:"nombre",title:"Nombre",class:""},{data:"estado",title:"Estado",className:"estado none"},{data:"edad",title:"Edad",className:"never"},{data:"nivelAcademico",title:"Nivel académico",className:"none"}];I(()=>{m.value&&(V(),s.value=D.params.id,r.getDepartamento(s.value).then(()=>{o.value=r.data,f.value=r.data.empleados?r.data.empleados:[],console.log(o.value),console.log(f.value),G(()=>{g.value=!0,w(),q()})}))});const w=()=>{if(g.value=!0,n.value=!0,o.value.nombre==null||o.value.nombre==null||o.value.nombre==""?(h.value.nombre="El nombre es obligatorio",n.value=!1):h.value.nombre="",!n.value){b("error","Verifique los campos marcados en rojo");return}};return{options:j,empleados:f,columns:z,data:o,validate:w,submit:()=>{w();let l={...o.value};if(m.value){var B=o.value.id;E("¿Estás seguro?","Se actualizarán los datos del departamento","warning","Sí, actualizar","No, cancelar").then(y=>{y?r.putDepartamento(l,B).then(t=>{console.log(t),t.status==200?T("¡Éxito!","El departamento se ha actualizado correctamente","success","Aceptar").then(()=>{p.push({name:"departamentos"})}):C("Error",t.response.data,"error","Aceptar")}).catch(t=>{console.log("error",t),C("Error",t.response.data,"error","Aceptar")}):b("info","No se actualizaron los datos")})}else E("¿Estás seguro?","Se registrara el departamento","warning","Sí, registrar","No, cancelar").then(y=>{y?r.postDepartamento(l).then(t=>{console.log(t),t.status==201?T("¡Éxito!","El departamento se ha registrado correctamente","success","Aceptar").then(()=>{p.push({name:"departamentos"})}):C("Error",t.response.data.message,"error","Aceptar")}).catch(t=>{console.log(t),b("error","Ocurrió un error al registrar el departamento")}):b("info","No se registraron los datos")})},cancelar:()=>{E("¿Deseas cancelar?","Los cambios no guardados se perderán","question","Sí, cancelar","No, regresar").then(l=>{l&&p.push({name:"departamentos"})})},error:h,validated:g,isEdit:m,eliminar:()=>{x.fire({title:"Se requiere confirmación",text:"Esta acción eliminará al departamento de forma permanente y todos los empleados adscritos se quedarán sin departamento asignado. Esta acción solo la puede realizar el Administrador.",icon:"warning",iconColor:"#dc3545",input:"checkbox",inputValue:0,inputPlaceholder:"Entiendo, quiero continuar",confirmButtonText:'Continuar <i class="bi bi-shield-exclamation"></i>',confirmButtonColor:"#dc3545",cancelButtonText:"Cancelar</i>",showCancelButton:!0,inputValidator:l=>!l&&"Debes confirmar que entiendes las consecuencias de esta acción"}).then(l=>{l.value&&r.deleteDepartamento(o.value.id).then(()=>{x.fire({icon:"success",title:"¡Éxito!",text:"El departamento ha sido eliminado de forma permanente"}).then(()=>{p.push({name:"departamentos"})})}).catch(B=>{b("error","Ocurrió un error al eliminar el departamento")})})},goBack:()=>p.go(-1)}},components:{InputText:O}}),Y={class:"container-lg pt-4 my-3"},Z={class:"card shadow-5 border-round-2xl overflow-hidden"},ee={class:"d-flex relative card-header py-0 pe-0"},ae={class:"flex text-center"},te={key:0,class:"bi bi-person-fill-gear fw-bold h1 my-0"},oe={key:1,class:"bi bi-person-fill-add fw-bold h1 my-0"},se={class:"fw-bold h4 align-self-center ms-3 my-0"},re={id:"form"},ne={class:"card-body"},le={class:"grid"},ie={class:"col-12 md:col-offset-3 md:col-6"},de=e("label",{for:"curp",class:"form-label"},[S("Nombre del departamento"),e("b",{class:"p-error"},"*")],-1),ce={key:0,class:"p-error"},ue=e("small",null,[e("b",{class:"text-danger"},"*"),S(" Campos obligatorios")],-1),me={class:"card-footer d-flex"},pe={class:"card mt-5 border-round-2xl overflow-hidden shadow-5"},he={class:"container table-responsive"},fe={key:0,class:"table table-hover",id:"empleados"},be=e("thead",null,[e("tr",null,[e("th"),e("th",null,"Tarjeta"),e("th",null,"RFC"),e("th",null,"Nombre"),e("th",null,"Estado"),e("th",null,"Edad"),e("th",null,"Nivel académico")])],-1),ve=e("td",null,null,-1);function ge(a,m,D,p,r,g){const n=k("Button"),h=k("InputText"),o=k("Panel");return i(),u("div",Y,[e("div",Z,[e("div",ee,[e("span",ae,[a.isEdit?(i(),u("i",te)):(i(),u("i",oe)),e("span",se,d(a.isEdit?" Editar":"Registrar")+" Departamento ",1)]),v(n,{icon:"pi pi-times",severity:"danger",size:"small",onClick:a.goBack,class:"ms-auto border-noround float-end hover:bg-red-500 hover:text-white",text:"",style:{height:"48px"}},null,8,["onClick"])]),e("form",re,[e("div",ne,[e("div",le,[e("div",ie,[de,v(h,{modelValue:a.data.nombre,"onUpdate:modelValue":m[0]||(m[0]=s=>a.data.nombre=s),placeholder:"Nombre sin el prefijo 'Departamento'",class:U(["w-full",{"p-invalid":a.error.nombre&&a.validated}]),id:"nombre",autocomplete:"off",required:""},null,8,["modelValue","class"]),a.validated?(i(),u("small",ce,d(a.error.nombre||""),1)):N("",!0)])]),ue]),e("div",me,[a.isEdit?(i(),H(n,{key:0,icon:"pi pi-trash",class:"me-2",label:"Eliminar",onClick:a.eliminar,severity:"danger"},null,8,["onClick"])):N("",!0),v(n,{icon:"pi pi-check",id:"submitButton",class:"me-2 ms-auto",label:"Guardar",onClick:a.submit},null,8,["onClick"]),v(n,{icon:"pi pi-times",class:"ms-2 float-end",severity:"secondary",label:"Cancelar",onClick:a.cancelar},null,8,["onClick"])])])]),e("div",pe,[v(o,{header:"Tabla de empleados",toggleable:""},{default:M(()=>[e("div",he,[a.empleados&&a.empleados.length>0?(i(),u("table",fe,[be,e("tbody",null,[(i(!0),u(W,null,J(a.empleados,(s,f)=>(i(),u("tr",{key:f},[ve,e("td",null,d(s.numeroTarjeta),1),e("td",null,d(s.rfc),1),e("td",null,d(s.nombre),1),e("td",null,d(s.estado),1),e("td",null,d(s.edad),1),e("td",null,d(s.nivelAcademico),1)]))),128))])])):N("",!0)])]),_:1})])])}const ke=P(X,[["render",ge]]);export{ke as D};
