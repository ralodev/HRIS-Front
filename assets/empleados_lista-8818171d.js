import{_ as L,P as E,D as m,g as x,a as _,b as N,c as I,d as n,e as h,h as B,r as y,u as S,o as k,$ as l,s as D,n as V,i as R}from"./index-6a8c1a4d.js";import{u as O}from"./empleadoStore-f5d3fb13.js";E.use(m,m,m,m);const $=x({name:"TablaEmpleados",components:{DataTable:E},setup(){const s=y("");let i;const f=y(),v=O(),o=R(),c=S(),p=y([]),u={responsive:{details:{renderer:function(e,a,r){var t=A(e,a,r);return t||!1},display:function(e,a,r){if(a){if(l(e.node()).hasClass("parent"))return e.child(r(),"child").show(),l("div.slider",e.child()).slideDown(0),!0}else return e.child.isShown()?(l("div.slider",e.child()).slideUp(function(){e.child(!1),l(e.node()).removeClass("parent shown")}),!1):(e.child(r(),"child").show(),l(e.node()).addClass("parent shown"),l("div.slider",e.child()).slideDown(),!0)}}},autoWidth:!0,dom:"trip",paging:!0,pagingType:"numbers",language:D,pageLength:10,order:[[2,"asc"]],columnDefs:[{responsivePriority:1,targets:[0,2,10]},{responsivePriority:2,targets:[4]}],initComplete:function(){this.on("draw.dt",function(){V(()=>{T(),i.responsive.recalc()})})}},b=[{data:null,className:"dt-control",orderable:!1,defaultContent:"",width:"1%",class:""},{data:"numeroTarjeta",title:"Tarjeta",width:"5%",class:""},{data:"rfc",title:"RFC",class:""},{data:"curp",title:"CURP",class:""},{data:"nombre",title:"Nombre",class:""},{data:"departamento.nombre",title:"Departamento",class:"",render:function(e,a,r){return e??"Sin departamento"}},{data:"estado",title:"Estado",className:"estado none"},{data:"correoInstitucional",title:"Correo",className:"none"},{data:"edad",title:"Edad",className:"never"},{data:"nivelAcademico",title:"Nivel académico",className:"none"},{data:null,orderable:!1,class:"text-nowrap  acciones justify-content-center",width:"5%",title:"Acciones",wrap:!0,render:function(e){return'<a title="Ver empleado" name="'+e.id+'" class="edit me-1 px-3 p-button-sm p-button p-component p-button-icon-only p-button-primary p-button-raised text-decoration-none"><i class="pi pi-pencil"></i></a> '}}],g=async()=>{var e=!1;o.showLoading("Cargando datos"),setTimeout(()=>{e||(o.closeLoading(),o.showWarningAlert("Oops!","El servidor está tardando demasiado en responder")),setTimeout(()=>{e||(o.closeWarning(),o.showErrorAlert("Error","No se pudo conectar con el servidor"))},1e4)},5e3),await v.getEmpleados().then(a=>{a.status==200?p.value=v.data:o.showErrorAlert("Error","Ocurrió un error inesperado")}).catch(a=>{a.code==="ERR_NETWORK"?o.showErrorAlert("Error","No se pudo conectar con el servidor"):o.showErrorAlert("Error","Ocurrió un error inesperado")}).finally(()=>{o.closeLoading(),e=!0})},w=e=>{c.push({name:"empleados_editar",params:{id:e}})},T=()=>{const e=document.querySelectorAll(".edit"),a=document.querySelectorAll(".acciones-plaza"),r=document.querySelectorAll(".estado");e.forEach(t=>{t.addEventListener("click",()=>{w(t.attributes.name.value)})}),a.forEach(t=>{t.parentElement.classList.add("flex"),t.parentElement.previousSibling.previousSibling.previousSibling.previousSibling.innerHTML!=="ACTIVO"&&(t.disabled=!0,t.classList.remove("p-button-help"),t.classList.add("p-button-secondary"),t.classList.add("p-disabled"),t.parentElement.title="Empleado inactivo o no disponible"),t.addEventListener("click",()=>{c.push({name:"plazas_registrar",params:{id:t.attributes.name.value}})})}),r.forEach(t=>{t.innerHTML=="INACTIVO"?t.parentElement.classList.add("bg-yellow-100"):t.innerHTML=="BAJA"&&t.parentElement.classList.add("bg-red-100")})},C=()=>{i.search(s.value).draw()};k(()=>{g(),i=f.value.dt});function A(e,a,r){var t=l.map(r,function(d,F){return d.hidden?'<tr data-dt-row="'+d.rowIndex+'" data-dt-column="'+d.columnIndex+'"><td><b>'+d.title+"</b></td> <td>"+d.data+"</td></tr>":""}).join("");return t?'<div class="slider"><table>'+t+"</table></div>":void 0}return{columns:b,data:p,options:u,registrar:()=>{c.push({name:"empleados_registrar"})},search:C,searchText:s,table:f}}}),j={class:"container-lg pt-4 my-3"},K={class:"card shadow-5 border-round-2xl overflow-hidden"},M=n("div",{class:"d-flex card-header py-0 pe-0"},[n("span",{class:"flex text-center"},[n("i",{class:"bi bi-people-fill fw-bold h1 my-0"}),n("span",{class:"fw-bold h4 align-self-center ms-3 my-0"}," Empleados ")])],-1),P={class:"card-body table-responsive"},W={class:"grid mb-2"},q={class:"col-12 lg:col-6 md:col-8"},H={class:"p-inputgroup"},U={class:"col-12 lg:col-6 md:col-4"};function z(s,i,f,v,o,c){const p=_("InputText"),u=_("Button"),b=_("DataTable");return N(),I("div",j,[n("div",K,[M,n("div",P,[n("div",W,[n("div",q,[n("div",H,[h(p,{placeholder:"Buscar empleado",id:"searchInput",onKeyup:B(s.search,["enter"]),modelValue:s.searchText,"onUpdate:modelValue":i[0]||(i[0]=g=>s.searchText=g),type:"search",autocomplete:"none"},null,8,["onKeyup","modelValue"]),h(u,{icon:"pi pi-search",severity:"primary",onClick:s.search},null,8,["onClick"])])]),n("div",U,[h(u,{type:"button",label:"Nuevo",icon:"pi pi-plus",onClick:s.registrar,class:"float-end",raised:""},null,8,["onClick"])])]),h(b,{columns:s.columns,data:s.data,class:"responsive text-nowrap hover row-border border order-column",width:"100%",options:s.options,ref:"table"},null,8,["columns","data","options"])])])])}const Q=L($,[["render",z]]);export{Q as default};
