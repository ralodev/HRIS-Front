import{_ as h,u as p,r as n,o as w,a as g,b as f,c as v,d as t,Q as _,e as x,h as y,p as b,q as E,F as C,i as S,f as T}from"./index-1eadb02e.js";import{u as k}from"./usuarioStore-53e5fc9b.js";import{u as A}from"./configStore-da2d9a8f.js";const O={name:"Login",setup(){const m=k(),i=A();p();const o=S(),e=n(!1),d=n(!1),u=n(!1),s=n(null),l=n(!1),a=n({email:"",nombre:"",apellidos:"",rol:"EMPLEADO"});return w(()=>{i.getRegistrationStatus().then(c=>{console.log(c),c.response.status===200?l.valueOf=!1:(l.valueOf=!0,o.showErrorAlert("Registro deshabilitado","El administrador ha deshabilitado el registro de usuarios"))}).catch(c=>{l.valueOf=!0,o.showErrorAlert("Registro deshabilitado","El administrador ha deshabilitado el registro de usuarios")}),console.log(l),document.querySelector("input").focus()}),{onSubmit:()=>{if(e.value=!0,d.value=!1,!new RegExp("^[a-zA-Z0-9._%+-]+@(itoaxaca.edu.mx|oaxaca.tecnm.mx)$").test(a.value.email)){o.showErrorAlert("Correo no válido"),e.value=!1;return}o.showLoading(),m.registrar(a.value.email).then(r=>{o.closeLoading(),e.value=!1,r.status===200?(o.showSuccessAlert("Registro exitoso","Se ha enviado un correo de confirmación a tu correo electrónico"),s.value=null):(d.value=!0,o.showErrorAlert("Error",r.response.data))}).catch(r=>{o.closeLoading(),o.showErrorAlert(r)})},data:a,loading:e,wrongCredentials:d,see:u,verifyEmail:()=>{if(!new RegExp("^[a-zA-Z0-9._%+-]+@(itoaxaca.edu.mx|oaxaca.tecnm.mx|gmail.com)$").test(a.value.email)){o.showErrorToast("Correo no válido"),e.value=!1;return}m.consultarCorreo(a.value.email).then(r=>{r.status===200?(s.value=!0,o.showSuccessToast("Correo encontrado")):(s.value=!1,o.showErrorToast("Correo no encontrado"))}).catch(r=>{s.value=null,o.showErrorToast("Ocurrió un error al verificar el correo")})},found:s,registrationDisabled:l,found_to_null(){s.value=null},seeTrue(){u.value=!0},seeFalse(){u.value=!1}}}},R={class:"container-fluid surface-0"},j={class:"surface-card w-full md:w-8 lg:w-6 mx-auto v-center",style:{"max-width":"500px","padding-top":"3rem","padding-bottom":"8rem"}},I=t("div",{class:"text-center mb-2"},[t("div",{class:"text-900 text-4xl pb-5 font-medium"},"Regístrate")],-1),V=t("label",{for:"email",class:"block text-900 text-lg font-medium mb-2"},"Correo electrónico institucional",-1),M={class:"p-inputgroup"},q=t("span",{class:"block text-justify text-color mb-3"},"Introduce tu correo institucional y verifica que se encuentre en la base de datos.",-1),z={key:0,class:"block text-justify text-danger mb-3"},B={key:1,class:"block text-justify text-success mb-3"},D=T('<footer><div class="row mx-0 justify-content-center mb-0 pt-5 pb-0 row-2 px-3"><div class="col-12"><div class="row row-2"><div class="col-sm-4 my-sm-0"><ul class="list-unstyled"><li class="mt-0 fw-bold">Dirección</li><li>Avenida Ing. Víctor Bravo Ahuja No. 125 Esquina Calzada Tecnológico, C.P. 68030</li><li class="mt-3 fw-bold">Contacto</li><li>Email: <a href="mailto:jefatura.humanos@oaxaca.tecnm.mx" style="color:#fff;">jefatura.humanos@oaxaca.tecnm.mx</a></li><li>Tel: (951) 501 50 16 Ext. 1055</li></ul></div><div class="col-sm-4 my-sm-0"><ul class="list-unstyled"><li class="mt-0 fw-bold">Enlaces</li><li class="mt-1"><a href="www.oaxaca.tecnm.mx" style="color:#fff;text-decoration:none;">Instituto Tecnológico de Oaxaca</a></li><li class="mt-1"><a href="https://it.sgwebcualli.com/Oaxaca/" style="color:#fff;text-decoration:none;">Sistema de Gestión de la Calidad</a></li><li class="mt-1"><a href="http://www.oaxaca.tecnm.mx/directorio" style="color:#fff;text-decoration:none;">Directorio</a></li></ul></div><div class="col-sm-3 text-md-center"><h5><span><i class="fa fa-firefox text-light" aria-hidden="true"></i></span><b> Instituto tecnológico de Oaxaca</b></h5></div></div></div></div><div class="row mx-0 justify-content-center mt-0 pt-0 row-1 mb-0 px-sm-3 px-2"><div class="col-12"><div class="row mx-0 my-1 row-1 no-gutters"><div class="text-center">Recursos Humanos © 2023 Instituto Tecnológico de Oaxaca. Todos los derechos reservados. </div><div class="col-md-3 col-auto"></div><div class="col-md-3 col-auto"></div></div></div></div></footer>',1);function N(m,i,o,e,d,u){const s=g("InputText"),l=g("Button");return f(),v(C,null,[t("div",R,[t("div",j,[I,t("div",null,[t("form",{id:"login",onSubmit:i[1]||(i[1]=_((...a)=>e.onSubmit&&e.onSubmit(...a),["prevent"])),class:"px-5"},[V,t("div",M,[x(s,{placeholder:"Introduce tu correo electrónico",id:"searchInput",onKeyup:y(e.verifyEmail,["enter"]),modelValue:e.data.email,"onUpdate:modelValue":i[0]||(i[0]=a=>e.data.email=a),autocomplete:"email",required:"",onKeypress:e.found_to_null,disabled:e.registrationDisabled.valueOf},null,8,["onKeyup","modelValue","onKeypress","disabled"]),x(l,{class:"transition-all transition-duration-500",icon:"pi pi-search",label:e.see?"Verificar":null,severity:"primary",onClick:e.verifyEmail,onMouseover:e.seeTrue,onMouseout:e.seeFalse,disabled:e.registrationDisabled.valueOf},null,8,["label","onClick","onMouseover","onMouseout","disabled"])]),q,e.found==!1?(f(),v("span",z,"No hubo coincidencias. Si ese es tu correo institucional y eres trabajador del instituto, debes acudir al departamento de Recursos Humanos para actualizar el que se tiene en tu registro.")):b("",!0),e.found==!0?(f(),v("span",B,"Haz click en el botón de abajo para registrarte y en unos minutos recibirás un correo electrónico con instrucciones.")):b("",!0),x(l,{type:"submit",label:e.loading?null:"Registrarme",icon:e.found?"pi pi-check":"pi pi-times",class:E([e.found?"bg-primary-700":"bg-gray-700 border-gray-700","w-full hover:shadow-3 hover:bg-primary-600"]),loading:e.loading,disabled:!e.found},null,8,["label","icon","class","loading","disabled"])],32)])])]),D],64)}const Z=h(O,[["render",N]]);export{Z as default};
