import{g as ee,_ as oe,r as m,k as ae,u as le,o as se,n as ne,l as ie,a as k,m as te,b as i,c as r,d as o,t as p,e as c,j as A,p as d,q as v,v as U,x as W,y as re,z as de,A as ce,B as ue,C as me,E as pe,i as X,S as _,G as f}from"./index-66b45988.js";import{u as ve}from"./empleadoStore-0061b699.js";import{u as fe}from"./departamentoStore-037c0ba1.js";const he=ee({name:"EmpleadoForm",watch:{},props:{isEdit:{type:Boolean,default:!1}},setup(e){const a=m(e.isEdit),R=m(re),F=m(de),P=m(ce),z=m(ue),g=m(me),b=m(pe),C=ae(),h=le(),E=ve(),S=fe(),l=m([]),T=m(!1),t=m(!1),n=m({}),s=m({});m(null);const B=X(),{showToast:y,showSuccessAlert:q,showConfirmAlert:L,showErrorAlert:N,showLoading:ko,closeLoading:x}=X();se(()=>{B.showLoading("Cargando datos..."),S.getDepartamentos().then(()=>{l.value=S.data,l.value.forEach(u=>{delete u.empleados}),a.value?E.getEmpleado(C.params.id).then(()=>{s.value=E.data,ne(()=>{B.closeLoading(),T.value=!0,M(),x()})}):(B.closeLoading(),s.value={})})});function O(){s.value.nombre?n.value.nombre="":(n.value.nombre="El nombre es obligatorio",t.value=!1)}function $(){s.value.rfc?/^[A-Z]{4}\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])[A-Z\d]{3}$/.test(s.value.rfc)?(n.value.rfc="",j()):(n.value.rfc="El RFC no tiene un formato válido",t.value=!1,document.getElementById("rfc").focus()):(n.value.rfc="El RFC es obligatorio",t.value=!1,document.getElementById("rfc").focus())}function j(){s.value.curp?/^[A-Z]{4}\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])[HM](AS|BC|BS|CC|CH|CL|CM|CS|DF|DG|GR|GT|HG|JC|MC|MN|MS|NE|NL|NT|OC|PL|QT|QR|SP|SL|SR|TC|TL|TS|VZ|YN|ZS)[A-Z]{3}[0-9A-Z]{2}$/.test(s.value.curp)?s.value.rfc.substring(0,10)!=s.value.curp.substring(0,10)?(n.value.curp="La CURP no coincide con el RFC",t.value=!1,document.getElementById("curp").focus()):(n.value.curp="",D()):(n.value.curp="La CURP no tiene un formato válido",t.value=!1,document.getElementById("curp").focus()):(n.value.curp="La CURP es obligatoria",t.value=!1,document.getElementById("curp").focus())}function D(){s.value.sexo?s.value.sexo=="MASCULINO"&&s.value.curp.substring(10,11)!="H"||s.value.sexo=="FEMENINO"&&s.value.curp.substring(10,11)!="M"?(n.value.sexo="El sexo no coincide con la CURP",t.value=!1):n.value.sexo="":(n.value.sexo="El sexo es obligatorio",t.value=!1)}function H(){s.value.nivelAcademico?n.value.nivelAcademico="":(n.value.nivelAcademico="El nivel académico es obligatorio",t.value=!1,document.getElementById("nivelAcademico").focus())}function Z(){s.value.correoInstitucional?/^[^\s@]+@[^\s@]+\.[^\s@]+$/i.test(s.value.correoInstitucional)?n.value.correoInstitucional="":(n.value.correoInstitucional="El correo no tiene un formato válido",t.value=!1):(n.value.correoInstitucional="El correo institucional es obligatorio",t.value=!1)}function G(){s.value.numeroTarjeta?n.value.numeroTarjeta="":(n.value.numeroTarjeta="El número de tarjeta es obligatorio",t.value=!1)}function J(){s.value.departamento?n.value.departamento="":(n.value.departamento="Debe seleccionar un departamento",t.value=!1)}function Y(){s.value.tipoMovimiento?n.value.tipoMovimiento="":(n.value.tipoMovimiento="Debe seleccionar el tipo de movimiento",t.value=!1)}function Q(){var u=new Date().getFullYear();s.value.fechaIngreso?s.value.fechaIngreso.substring(0,4)<1900||s.value.fechaIngreso.substring(0,4)>u?(n.value.fechaIngreso="La fecha de ingreso no es válida",t.value=!1):n.value.fechaIngreso="":(n.value.fechaIngreso="La fecha de ingreso es obligatoria",t.value=!1)}function K(){s.value.estado?s.value.estado=="BAJA"&&!s.value.fechaBaja?(n.value.fechaBaja="Debe ingresar la fecha de baja",t.value=!1):(n.value.fechaBaja="",n.value.estado=""):(n.value.estado="El estado es obligatorio",t.value=!1)}const M=async()=>(T.value=!0,t.value=!0,O(),$(),j(),D(),H(),Z(),G(),J(),Y(),K(),Q(),!!t.value);return{data:s,validate:M,submit:()=>{M().then(w=>{if(!w){console.log(w),y("error","Verifique los campos marcados en rojo");return}});let u={...s.value};if((s.value.discapacidades==null||s.value.discapacidades==null||s.value.discapacidades=="")&&(u.discapacidades=[]),(s.value.lenguas==null||s.value.lenguas==null||s.value.lenguas=="")&&(u.lenguas=[]),a.value){var I=s.value.id;L("¿Estás seguro?","Se actualizarán los datos del empleado","warning","Sí, actualizar","No, cancelar").then(w=>{w?E.putEmpleado(u,I).then(V=>{V.status==200?q("¡Éxito!","El empleado se ha actualizado correctamente","success","Aceptar").then(()=>{h.push({name:"empleados"})}):N("Error",V.response.data)}).catch(V=>{y("error","Ocurrió un error al actualizar el empleado")}):y("info","No se actualizaron los datos")})}else L("¿Estás seguro?","Se registrarán los datos del empleado","warning","Sí, registrar","No, cancelar").then(w=>{w?E.postEmpleado(u).then(V=>{V.status==201?q("¡Éxito!","El empleado se ha registrado correctamente","success","Aceptar").then(()=>{h.push({name:"empleados"})}):N("Error",V.response.data)}).catch(V=>{y("error","Ocurrió un error al registrar el empleado")}):y("info","No se registraron los datos")})},cancelar:()=>{L("¿Deseas cancelar?","Los cambios no guardados se perderán","question","Sí, cancelar","No, regresar").then(u=>{u&&h.push({name:"empleados"})})},opcDiscapacidades:g,opcSexo:R,opcNivelAcademico:b,error:n,validated:T,isEdit:a,opcDepartamento:l,opcTipoMovimiento:P,opcEstado:z,opcLenguas:F,vNombre:O,vRfc:$,vCurp:j,vSexo:D,vNivelAcademico:H,vCorreoInstitucional:Z,vNumeroTarjeta:G,vDepartamento:J,vTipoMovimiento:Y,vFechaIngreso:Q,vEstado:K,eliminar:()=>{_.fire({title:"Se requiere confirmación",text:"Esta acción eliminará al empleado de forma permanente y no se puede revertir, se recomienda dar de baja al empleado en lugar de eliminarlo. El administrador del sitio será notificado de esta acción.",icon:"warning",iconColor:"#dc3545",input:"checkbox",inputValue:0,inputPlaceholder:"Entiendo, quiero continuar",confirmButtonText:'Continuar <i class="bi bi-shield-exclamation"></i>',confirmButtonColor:"#dc3545",cancelButtonText:"Cancelar</i>",showCancelButton:!0,inputValidator:u=>!u&&"Debes confirmar que entiendes las consecuencias de esta acción"}).then(u=>{u.value&&E.deleteEmpleado(s.value.id).then(I=>{I.status==200?_.fire({icon:"success",title:"¡Éxito!",text:"El empleado ha sido eliminado de forma permanente"}).then(()=>{h.push({name:"empleados"})}):N("Error",I.response.data)}).catch(I=>{console.log(I),y("error","Ocurrió un error al eliminar el empleado")})})},verExpediente:()=>h.push({name:"empleados_expediente",params:{id:s.value.id}}),goBack:()=>h.go(-1),verHistorial:()=>h.push({name:"empleados_historial",params:{id:s.value.id}})}},components:{InputText:ie}}),be={class:"container-lg pt-4 my-3"},ge={class:"card shadow-5 border-round-2xl overflow-hidden"},Ce={class:"d-flex relative card-header py-0 pe-0"},Ee={class:"flex text-center"},Ve={key:0,class:"bi bi-person-fill-gear fw-bold h1 my-0"},ye={key:1,class:"bi bi-person-fill-add fw-bold h1 my-0"},Ie={class:"fw-bold h4 align-self-center ms-3 my-0"},we={id:"form"},ke={class:"card-body"},Ae={class:"grid"},Se={class:"col-12"},Te=o("span",{class:"fs-5 fw-bold"},"Datos personales",-1),Be={class:"col-12 lg:col-6"},Le=o("label",{for:"nombre",class:"form-label"},[f("Nombre completo"),o("b",{class:"p-error"},"*")],-1),Ne={key:0,class:"p-error"},je={class:"col-12 md:col-4 lg:col-3"},De=o("label",{for:"rfc",class:"form-label"},[f("RFC"),o("b",{class:"p-error"},"*")],-1),Me={key:0,class:"p-error"},Ue={class:"col-12 md:col-4 lg:col-3"},Re=o("label",{for:"curp",class:"form-label"},[f("CURP"),o("b",{class:"p-error"},"*")],-1),Fe={key:0,class:"p-error"},Pe={key:0,class:"col-4 md:col-4 lg:col-3"},ze=o("label",{for:"edad",class:"form-label"},"Edad",-1),qe=o("label",{for:"genero",class:"form-label"},[f("Sexo"),o("b",{class:"text-danger"},"*")],-1),Oe={key:0,class:"p-error"},$e={class:"col-12 md:col-6"},He=o("label",{for:"nivelAcademico",class:"form-label"},[f("Nivel Académico"),o("b",{class:"text-danger"},"*")],-1),Ze={key:0,class:"p-error"},Ge={class:"col-12 md:col-6"},Je=o("label",{for:"inputCorreo",class:"form-label"},"Correo electrónico",-1),Ye={key:0,class:"p-error"},Qe={class:"col-12 md:col-6"},Ke=o("label",{for:"profesion",class:"form-label"},"Profesión",-1),We={class:"col-12 md:col-6 lg:col-6"},Xe=o("label",{for:"genero",class:"form-label"},"Lenguas indígenas",-1),_e={class:"col-12 md:col-6 lg:col-6"},xe=o("label",{for:"genero",class:"form-label"},"Discapacidades",-1),eo=o("div",{class:"col-12"},[o("span",{class:"fs-5 fw-bold"},"Datos laborales")],-1),oo={class:"col-6 md:col-6 lg:col-4"},ao=o("label",{for:"tarjeta",class:"form-label"},[f("Número de tarjeta"),o("b",{class:"text-danger"},"*")],-1),lo={key:0,class:"p-error"},so={class:"col-12 md:col-6 lg:col-4"},no=o("label",{for:"inputDepartamento",class:"form-label"},[f("Departamento de adscripción"),o("b",{class:"text-danger"},"*")],-1),io={key:0,class:"p-error"},to={class:"col-6 md:col-6 lg:col-4"},ro=o("label",{for:"inputTipoMovimiento",class:"form-label"},[f("Tipo de movimiento"),o("b",{class:"text-danger"},"*")],-1),co={key:0,class:"p-error"},uo={class:"col-6 md:col-4"},mo=o("label",{for:"fechaIngreso",class:"form-label"},[f("Fecha de ingreso"),o("b",{class:"text-danger"},"*")],-1),po={key:0,class:"p-error"},vo={class:"col-6 md:col-4"},fo=o("label",{for:"inputEstado",class:"form-label"},[f("Estado del empleado"),o("b",{class:"text-danger"},"*")],-1),ho={key:0,class:"p-error"},bo={key:1,class:"col-6 md:col-4"},go=o("label",{for:"fechaBaja",class:"form-label"},"Fecha de baja",-1),Co={key:0,class:"p-error"},Eo={class:"col-12 md:col-12"},Vo=o("label",{for:"inputComentario",class:"form-label"},"Comentarios",-1),yo=o("small",null,[o("b",{class:"text-danger"},"*"),f(" Campos obligatorios")],-1),Io={class:"card-footer d-flex"};function wo(e,a,R,F,P,z){const g=k("Button"),b=k("InputText"),C=k("Dropdown"),h=k("MultiSelect"),E=k("TextArea"),S=te("tooltip");return i(),r("div",be,[o("div",ge,[o("div",Ce,[o("span",Ee,[e.isEdit?(i(),r("i",Ve)):(i(),r("i",ye)),o("span",Ie,p(e.isEdit?" Editar":"Registrar")+" empleado ",1)]),c(g,{icon:"pi pi-times",severity:"danger",size:"small",onClick:e.goBack,class:"ms-auto border-noround float-end hover:bg-red-500 hover:text-white",text:"",style:{height:"48px"}},null,8,["onClick"])]),o("form",we,[o("div",ke,[o("div",Ae,[o("div",Se,[Te,e.isEdit?(i(),A(g,{key:0,icon:"pi pi-history",class:"float-end",onClick:e.verHistorial,label:"Historial",size:"small",severity:"secondary"},null,8,["onClick"])):d("",!0),e.isEdit?(i(),A(g,{key:1,icon:"pi pi-book",class:"float-end me-2",onClick:e.verExpediente,label:"Expediente",size:"small",severity:"help"},null,8,["onClick"])):d("",!0)]),o("div",Be,[Le,c(b,{modelValue:e.data.nombre,"onUpdate:modelValue":a[0]||(a[0]=l=>e.data.nombre=l),placeholder:"Nombre completo, incluyendo apellidos",class:v(["w-full",{"p-invalid":e.error.nombre&&e.validated}]),id:"nombre",onInput:e.vNombre},null,8,["modelValue","class","onInput"]),e.validated?(i(),r("small",Ne,p(e.error.nombre||""),1)):d("",!0)]),o("div",je,[De,c(b,{modelValue:e.data.rfc,"onUpdate:modelValue":a[1]||(a[1]=l=>e.data.rfc=l),placeholder:"RFC con homoclave",class:v(["w-full",{"p-invalid":e.error.rfc&&e.validated}]),id:"rfc",minlength:"13",maxlength:"13",autocomplete:"off",onInput:e.vRfc},null,8,["modelValue","class","onInput"]),e.validated?(i(),r("small",Me,p(e.error.rfc||""),1)):d("",!0)]),o("div",Ue,[Re,c(b,{modelValue:e.data.curp,"onUpdate:modelValue":a[2]||(a[2]=l=>e.data.curp=l),placeholder:"CURP (18 caracteres)",class:v(["w-full",{"p-invalid":e.error.curp&&e.validated}]),id:"curp",minlength:"18",maxlength:"18",autocomplete:"off",onInput:e.vCurp},null,8,["modelValue","class","onInput"]),e.validated?(i(),r("small",Fe,p(e.error.curp||""),1)):d("",!0)]),e.isEdit?(i(),r("div",Pe,[ze,U(c(b,{modelValue:e.data.edad,"onUpdate:modelValue":a[3]||(a[3]=l=>e.data.edad=l),class:"w-full",readonly:e.isEdit},null,8,["modelValue","readonly"]),[[S,"Calculado automáticamente",void 0,{top:!0}]])])):d("",!0),o("div",{class:v([{"col-8 md:col-6":!e.isEdit},{"col-12 md:col-6 lg:col-3":e.isEdit}])},[qe,c(C,{modelValue:e.data.sexo,"onUpdate:modelValue":a[4]||(a[4]=l=>e.data.sexo=l),options:e.opcSexo,optionLabel:"nombre",optionValue:"nombre",placeholder:"Seleccione el sexo",class:v(["w-full",{"p-invalid":e.error.sexo&&e.validated}]),showClear:"",onChange:e.vSexo},null,8,["modelValue","options","class","onChange"]),e.validated?(i(),r("small",Oe,p(e.error.sexo||""),1)):d("",!0)],2),o("div",$e,[He,c(C,{modelValue:e.data.nivelAcademico,"onUpdate:modelValue":a[5]||(a[5]=l=>e.data.nivelAcademico=l),options:e.opcNivelAcademico,optionLabel:"nombre",inputId:"nivelAcademico",optionValue:"nombre",placeholder:"Seleccione el nivel académico",showClear:"",class:v(["w-full",{"p-invalid":e.error.nivelAcademico&&e.validated}]),onChange:e.vNivelAcademico},null,8,["modelValue","options","class","onChange"]),e.validated?(i(),r("small",Ze,p(e.error.nivelAcademico||""),1)):d("",!0)]),o("div",Ge,[Je,c(b,{modelValue:e.data.correoInstitucional,"onUpdate:modelValue":a[6]||(a[6]=l=>e.data.correoInstitucional=l),placeholder:"Correo (institucional)",class:v(["w-full",{"p-invalid":e.error.correoInstitucional&&e.validated}]),id:"correo",onInput:e.vCorreoInstitucional,required:""},null,8,["modelValue","class","onInput"]),e.validated?(i(),r("small",Ye,p(e.error.correoInstitucional||""),1)):d("",!0)]),o("div",Qe,[Ke,c(b,{modelValue:e.data.profesion,"onUpdate:modelValue":a[7]||(a[7]=l=>e.data.profesion=l),placeholder:"Profesión",class:v(["w-full"]),id:"profesion"},null,8,["modelValue"])]),o("div",We,[Xe,(i(),A(h,{modelValue:e.data.lenguas,"onUpdate:modelValue":a[8]||(a[8]=l=>e.data.lenguas=l),options:e.opcLenguas,optionLabel:"nombre",placeholder:"Puede dejar este campo en blanco",selectedItemsLabel:"{0} discapacidades seleccionadas",maxSelectedLabels:3,selectionLimit:5,class:"w-full",filter:"",showToggleAll:!1,key:e.opcDiscapacidades.length},null,8,["modelValue","options"]))]),o("div",_e,[xe,(i(),A(h,{modelValue:e.data.discapacidades,"onUpdate:modelValue":a[9]||(a[9]=l=>e.data.discapacidades=l),options:e.opcDiscapacidades,optionLabel:"nombre",placeholder:"Puede dejar este campo en blanco",selectedItemsLabel:"{0} discapacidades seleccionadas",maxSelectedLabels:3,selectionLimit:5,class:"w-full",filter:"",showToggleAll:!1,key:e.opcDiscapacidades.length},null,8,["modelValue","options"]))]),eo,o("div",oo,[ao,c(b,{modelValue:e.data.numeroTarjeta,"onUpdate:modelValue":a[10]||(a[10]=l=>e.data.numeroTarjeta=l),placeholder:"Número de tarjeta",type:"number",class:v(["w-full",{"p-invalid":e.error.numeroTarjeta&&e.validated}]),id:"tarjeta",onInput:e.vNumeroTarjeta},null,8,["modelValue","class","onInput"]),e.validated?(i(),r("small",lo,p(e.error.numeroTarjeta||""),1)):d("",!0)]),o("div",so,[no,c(C,{modelValue:e.data.departamento,"onUpdate:modelValue":a[11]||(a[11]=l=>e.data.departamento=l),options:e.opcDepartamento,optionLabel:"nombre",placeholder:"Seleccione el departamento",showClear:"",class:v(["w-full",{"p-invalid":e.error.departamento&&e.validated}]),onChange:e.vDepartamento},null,8,["modelValue","options","class","onChange"]),e.validated?(i(),r("small",io,p(e.error.departamento||""),1)):d("",!0)]),o("div",to,[ro,c(C,{modelValue:e.data.tipoMovimiento,"onUpdate:modelValue":a[12]||(a[12]=l=>e.data.tipoMovimiento=l),options:e.opcTipoMovimiento,optionLabel:"nombre",optionValue:"nombre",placeholder:"Seleccione el tipo de movimiento",showClear:"",class:v(["w-full",{"p-invalid":e.error.tipoMovimiento&&e.validated}]),onChange:e.vTipoMovimiento},null,8,["modelValue","options","class","onChange"]),e.validated?(i(),r("small",co,p(e.error.tipoMovimiento||""),1)):d("",!0)]),o("div",uo,[mo,U(o("input",{"onUpdate:modelValue":a[13]||(a[13]=l=>e.data.fechaIngreso=l),type:"date",placeholder:"dd/mm/aaaa",class:"form-control",id:"fechaIngreso",onChange:a[14]||(a[14]=(...l)=>e.vFechaIngreso&&e.vFechaIngreso(...l))},null,544),[[W,e.data.fechaIngreso]]),e.validated?(i(),r("small",po,p(e.error.fechaIngreso||""),1)):d("",!0)]),o("div",vo,[fo,c(C,{modelValue:e.data.estado,"onUpdate:modelValue":a[15]||(a[15]=l=>e.data.estado=l),options:e.opcEstado,optionLabel:"nombre",optionValue:"nombre",placeholder:"Seleccione el estado",showClear:"",class:v(["w-full",{"p-invalid":e.error.estado&&e.validated},{"bg-red-50":e.data.estado==="BAJA"},{"bg-yellow-50":e.data.estado==="INACTIVO"},{"bg-green-50":e.data.estado==="ACTIVO"}]),onChange:e.vEstado,required:""},null,8,["modelValue","options","class","onChange"]),e.validated?(i(),r("small",ho,p(e.error.estado||""),1)):d("",!0)]),e.data.estado==="BAJA"?(i(),r("div",bo,[go,U(o("input",{"onUpdate:modelValue":a[16]||(a[16]=l=>e.data.fechaBaja=l),type:"date",placeholder:"dd/mm/aaaa",class:"form-control p-invalid",id:"fechaBaja"},null,512),[[W,e.data.fechaBaja]]),e.validated?(i(),r("small",Co,p(e.error.fechaBaja||""),1)):d("",!0)])):d("",!0),o("div",Eo,[Vo,c(E,{modelValue:e.data.comentarios,"onUpdate:modelValue":a[17]||(a[17]=l=>e.data.comentarios=l),placeholder:"Comentario o descripción (opcional)",class:v(["w-full"]),id:"comentarios",rows:"1",autoResize:""},null,8,["modelValue"])])]),yo]),o("div",Io,[e.isEdit?(i(),A(g,{key:0,icon:"pi pi-trash",class:"me-2",label:"Eliminar",onClick:e.eliminar,severity:"danger"},null,8,["onClick"])):d("",!0),c(g,{icon:"pi pi-check",id:"submitButton",class:"me-2 ms-auto",label:"Guardar",onClick:e.submit},null,8,["onClick"]),c(g,{icon:"pi pi-times",class:"ms-2 float-end",severity:"secondary",label:"Cancelar",onClick:e.cancelar},null,8,["onClick"])])])])])}const jo=oe(he,[["render",wo]]);export{jo as E};
