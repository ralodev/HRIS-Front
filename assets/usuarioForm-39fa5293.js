import{u as D}from"./adminStore-d135847e.js";import{g as q,_ as T,r as h,k as U,u as M,o as P,n as G,l as I,a as R,b as i,c as t,d as s,t as v,e as m,j as O,q as c,p as _,i as H,S as V,G as k,f as y}from"./index-11dec27b.js";const j=q({name:"UsuarioForm",watch:{},props:{isEdit:{type:Boolean,default:!1}},setup(e){const r=h(e.isEdit),A=U(),p=M(),f=D(),g=h(!1),l=h(!1),o=h({}),a=h({}),n=h(null),{showToast:b,showSuccessAlert:S,showConfirmAlert:E,showErrorAlert:w,showLoading:L,closeLoading:N}=H(),B=[{nombre:"ADMINISTRADOR",value:"ROLE_ADMIN"},{nombre:"EMPLEADO DE RECURSOS HUMANOS",value:"ROLE_EMPLEADO_HR"},{nombre:"ASISTENTE DE RECURSOS HUMANOS",value:"ROLE_ASISTENTE_HR"},{nombre:"EMPLEADO GENERAL",value:"ROLE_EMPLEADO"}];P(()=>{r.value&&(L(),n.value=A.params.id,f.getUsuario(n.value).then(()=>{a.value=f.data,console.log(a.value),G(()=>{g.value=!0,C(),N()})}))});const C=()=>{if(g.value=!0,l.value=!0,a.value.nombre==null||a.value.nombre==null||a.value.nombre==""?(o.value.nombre="El nombre es obligatorio",l.value=!1):o.value.nombre="",a.value.apellidos==null||a.value.apellidos==null||a.value.apellidos==""?(o.value.apellidos="Los apellidos son obligatorios",l.value=!1):o.value.apellidos="",a.value.email==null||a.value.email==null||a.value.email==""?(o.value.email="El correo electrónico es obligatorio",l.value=!1):a.value.email.includes("@")?o.value.email="":(o.value.email="El correo electrónico debe ser válido",l.value=!1),a.value.rol==null||a.value.rol==null||a.value.rol==""?(o.value.rol="El rol es obligatorio",l.value=!1):o.value.rol="",!l.value){b("error","Verifique los campos marcados en rojo");return}};return{data:a,validate:C,submit:()=>{C();let d={...a.value};if(r.value){var z=a.value.email;E("¿Estás seguro?","Se actualizarán los datos del usuario","warning","Sí, actualizar","No, cancelar").then(x=>{x?f.editarUsuario(z,d).then(u=>{console.log(u),u.status==200?S("¡Éxito!","El usuario se ha actualizado correctamente","success","Aceptar").then(()=>{p.push({name:"usuarios"})}):w("Error",u.response.data.mensaje,"error","Aceptar")}).catch(u=>{b("error","Ocurrió un error al actualizar el usuario")}):b("info","No se actualizaron los datos")})}else E("¿Estás seguro?","Se registrarán los datos del usuario","warning","Sí, registrar","No, cancelar").then(x=>{x?f.registrarUsuario(d).then(u=>{u.status==200?S("¡Éxito!","El usuario se ha registrado correctamente, recibirá un correo en unos minutos.","success","Aceptar").then(()=>{p.push({name:"usuarios"})}):w("Error",u.response.data.mensaje,"error","Aceptar")}).catch(u=>{b("error","Ocurrió un error al registrar el usuario")}):b("info","No se registraron los datos")})},cancelar:()=>{E("¿Deseas cancelar?","Los cambios no guardados se perderán","question","Sí, cancelar","No, regresar").then(d=>{d&&p.push({name:"usuarios"})})},error:o,validated:g,isEdit:r,eliminar:()=>{V.fire({title:"Se requiere confirmación",text:"Esta acción eliminará al usuario de forma permanente y no se puede revertir, puedes bloquear al usuario en su lugar y reactivarlo cuando lo desees.",icon:"warning",iconColor:"#dc3545",input:"checkbox",inputValue:0,inputPlaceholder:"Entiendo, quiero continuar",confirmButtonText:'Continuar <i class="bi bi-shield-exclamation"></i>',confirmButtonColor:"#dc3545",cancelButtonText:"Cancelar</i>",showCancelButton:!0,inputValidator:d=>!d&&"Debes confirmar que entiendes las consecuencias de esta acción"}).then(d=>{d.value&&f.deleteUsuario(a.value.email).then(()=>{V.fire({icon:"success",title:"¡Éxito!",text:"El usuario ha sido eliminado de forma permanente"}).then(()=>{p.push({name:"usuarios"})})}).catch(z=>{b("error","Ocurrió un error al eliminar el usuarios")})})},roles:B,goBack:()=>p.go(-1),verHistorial:()=>p.push({name:"usuarios_historial",params:{id:a.value.id}})}},components:{InputText:I}}),$={class:"container-lg pt-4 my-3"},F={class:"card shadow-5 border-round-2xl overflow-hidden"},J={class:"d-flex relative card-header py-0 pe-0"},K={class:"flex text-center"},Q={key:0,class:"bi bi-person-fill-gear fw-bold h1 my-0"},W={key:1,class:"bi bi-person-fill-add fw-bold h1 my-0"},X={class:"fw-bold h4 align-self-center ms-3 my-0"},Y={id:"form"},Z={class:"card-body"},ee={class:"grid"},se={class:"col-12"},ae={class:"col-12 md:col-offset-3 md:col-6"},oe=s("label",{for:"curp",class:"form-label"},[k("Correo electrónico"),s("b",{class:"p-error"},"*")],-1),le={key:0,class:"p-error"},ie={class:"col-12 md:col-offset-3 md:col-6"},re=s("label",{for:"nombre",class:"form-label"},[k("Nombre(s)"),s("b",{class:"p-error"},"*")],-1),te={key:0,class:"p-error"},ne={class:"col-12 md:col-offset-3 md:col-6"},ce=s("label",{for:"rfc",class:"form-label"},[k("Apellidos"),s("b",{class:"p-error"},"*")],-1),de={key:0,class:"p-error"},ue={class:"col-12 md:col-offset-3 md:col-6"},pe=s("label",{for:"genero",class:"form-label"},[k("Rol"),s("b",{class:"text-danger"},"*")],-1),me={key:0,class:"p-error"},fe={key:0,class:"col-12"},be=y('<strong class="text-color">Permisos del rol:</strong><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Consultar y modificar información de empleados (incluyendo historial)</span><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Consultar y modificar información de plazas</span><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Consultar y modificar información de departamentos</span><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Realizar consultas avanzadas y exportar los resultados</span><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Generar y exportar reportes</span><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Acceder al dashboard</span><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Registrar, eliminar, bloquear y desbloquear usuarios</span><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Generar y descargar respaldos de la Base de datos</span>',9),he=[be],ve={key:1,class:"col-12"},ke=y('<strong class="text-color">Permisos del rol:</strong><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Consultar y modificar información de empleados (incluyendo historial)</span><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Consultar y modificar información de plazas</span><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Consultar y modificar información de departamentos</span><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Realizar consultas avanzadas y exportar los resultados</span><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Generar y exportar reportes</span><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Acceder al dashboard</span><span class="block text-red-700 font-medium"><i class="pi pi-times-circle"></i> Registrar, eliminar, bloquear y desbloquear usuarios</span><span class="block text-red-700 font-medium"><i class="pi pi-times-circle"></i> Generar y descargar respaldos de la Base de datos</span>',9),ge=[ke],_e={key:2,class:"col-12"},ye=y('<strong class="text-color">Permisos del rol:</strong><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Consultar y modificar información de empleados (incluyendo historial)</span><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Consultar y modificar información de plazas</span><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Consultar y modificar información de departamentos</span><span class="block text-red-700 font-medium"><i class="pi pi-times-circle"></i> Realizar consultas avanzadas y exportar los resultados</span><span class="block text-red-700 font-medium"><i class="pi pi-times-circle"></i> Generar y exportar reportes</span><span class="block text-red-700 font-medium"><i class="pi pi-times-circle"></i> Acceder al dashboard</span><span class="block text-red-700 font-medium"><i class="pi pi-times-circle"></i> Registrar, eliminar, bloquear y desbloquear usuarios</span><span class="block text-red-700 font-medium"><i class="pi pi-times-circle"></i> Generar y descargar respaldos de la Base de datos</span>',9),Ee=[ye],Ce={key:3,class:"col-12"},xe=y('<strong class="text-color">Permisos del rol:</strong><span class="block text-green-700 font-medium"><i class="pi pi-check-circle"></i> Consultar su propia información (inf. personal, plazas y expediente)</span><span class="block text-red-700 font-medium"><i class="pi pi-times-circle"></i> Consultar y modificar información de plazas</span><span class="block text-red-700 font-medium"><i class="pi pi-times-circle"></i> Consultar y modificar información de departamentos</span><span class="block text-red-700 font-medium"><i class="pi pi-times-circle"></i> Realizar consultas avanzadas y exportar los resultados</span><span class="block text-red-700 font-medium"><i class="pi pi-times-circle"></i> Generar y exportar reportes</span><span class="block text-red-700 font-medium"><i class="pi pi-times-circle"></i> Acceder al dashboard</span><span class="block text-red-700 font-medium"><i class="pi pi-times-circle"></i> Registrar, eliminar, bloquear y desbloquear usuarios</span><span class="block text-red-700 font-medium"><i class="pi pi-times-circle"></i> Generar y descargar respaldos de la Base de datos</span>',9),Re=[xe],Ae=s("small",null,[s("b",{class:"text-danger"},"*"),k(" Campos obligatorios")],-1),Se={class:"card-footer d-flex"};function we(e,r,A,p,f,g){const l=R("Button"),o=R("InputText"),a=R("Dropdown");return i(),t("div",$,[s("div",F,[s("div",J,[s("span",K,[e.isEdit?(i(),t("i",Q)):(i(),t("i",W)),s("span",X,v(e.isEdit?" Editar":"Registrar")+" Usuario ",1)]),m(l,{icon:"pi pi-times",severity:"danger",size:"small",onClick:e.goBack,class:"ms-auto border-noround float-end hover:bg-red-500 hover:text-white",text:"",style:{height:"48px"}},null,8,["onClick"])]),s("form",Y,[s("div",Z,[s("div",ee,[s("div",se,[e.isEdit?(i(),O(l,{key:0,icon:"pi pi-book",class:"float-end border-none",onClick:e.verHistorial,label:"ver actividad",severity:"help"},null,8,["onClick"])):c("",!0)]),s("div",ae,[oe,m(o,{modelValue:e.data.email,"onUpdate:modelValue":r[0]||(r[0]=n=>e.data.email=n),autocomplete:"none",placeholder:"Direccion de correo electrónico",class:_(["w-full",{"p-invalid":e.error.email&&e.validated}])},null,8,["modelValue","class"]),e.validated?(i(),t("small",le,v(e.error.email||""),1)):c("",!0)]),s("div",ie,[re,m(o,{modelValue:e.data.nombre,"onUpdate:modelValue":r[1]||(r[1]=n=>e.data.nombre=n),placeholder:"Nombre de la persona, ej: Juan",class:_(["w-full",{"p-invalid":e.error.nombre&&e.validated}]),id:"nombre"},null,8,["modelValue","class"]),e.validated?(i(),t("small",te,v(e.error.nombre||""),1)):c("",!0)]),s("div",ne,[ce,m(o,{modelValue:e.data.apellidos,"onUpdate:modelValue":r[2]||(r[2]=n=>e.data.apellidos=n),placeholder:"Apellidos de la persona, ej: Perez Lopez",class:_(["w-full",{"p-invalid":e.error.apellidos&&e.validated}])},null,8,["modelValue","class"]),e.validated?(i(),t("small",de,v(e.error.apellidos||""),1)):c("",!0)]),s("div",ue,[pe,m(a,{modelValue:e.data.rol,"onUpdate:modelValue":r[3]||(r[3]=n=>e.data.rol=n),options:e.roles,optionLabel:"nombre",optionValue:"value",placeholder:"Elija el rol cuidadosamente",class:_(["w-full",{"p-invalid":e.error.rol&&e.validated}]),showClear:""},null,8,["modelValue","options","class"]),e.validated?(i(),t("small",me,v(e.error.rol||""),1)):c("",!0)]),e.data.rol=="ROLE_ADMIN"?(i(),t("div",fe,he)):c("",!0),e.data.rol=="ROLE_EMPLEADO_HR"?(i(),t("div",ve,ge)):c("",!0),e.data.rol=="ROLE_ASISTENTE_HR"?(i(),t("div",_e,Ee)):c("",!0),e.data.rol=="ROLE_EMPLEADO"?(i(),t("div",Ce,Re)):c("",!0)]),Ae]),s("div",Se,[e.isEdit?(i(),O(l,{key:0,icon:"pi pi-trash",class:"me-2",label:"Eliminar",onClick:e.eliminar,severity:"danger"},null,8,["onClick"])):c("",!0),m(l,{icon:"pi pi-check",id:"submitButton",class:"me-2 ms-auto",label:"Guardar",onClick:e.submit},null,8,["onClick"]),m(l,{icon:"pi pi-times",class:"ms-2 float-end",severity:"secondary",label:"Cancelar",onClick:e.cancelar},null,8,["onClick"])])])])])}const Be=T(j,[["render",we]]);export{Be as E};
