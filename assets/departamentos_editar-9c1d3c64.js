import{u as R}from"./departamentoStore-b6c23ffc.js";import{P as S,D as g,g as I,_ as A,r as p,k as P,u as L,o as O,n as G,l as U,a as C,b as r,c as h,d as e,t as d,e as _,p as M,q as N,j as V,w as W,F as H,N as J,i as K,s as Q,S as D,G as j}from"./index-06c4aa2d.js";S.use(g,g,g,g);const X=I({name:"DepartamentoForm",watch:{},props:{isEdit:{type:Boolean,default:!1}},components:{DataTable:S},setup(a){const c=p(a.isEdit),E=P(),u=L(),n=R(),f=p(!1),s=p(!1),b=p({}),t=p({}),o=p(null),v=p({}),{showToast:m,showSuccessAlert:T,showConfirmAlert:w,showErrorAlert:x,showLoading:$,closeLoading:z}=K(),q={responsive:!0,autoWidth:!0,dom:"trip",paging:!0,language:Q},F=[{data:null,className:"dt-control",orderable:!1,defaultContent:"",width:"1%",class:""},{data:"numeroTarjeta",title:"Tarjeta",width:"5%",class:""},{data:"rfc",title:"RFC",class:""},{data:"curp",title:"CURP",class:""},{data:"nombre",title:"Nombre",class:""},{data:"estado",title:"Estado",className:"estado none"},{data:"edad",title:"Edad",className:"never"},{data:"nivelAcademico",title:"Nivel académico",className:"none"}];O(()=>{c.value&&($(),o.value=E.params.id,n.getDepartamento(o.value).then(()=>{t.value=n.data,v.value=n.data.empleados,console.log(t.value),console.log(v.value),G(()=>{f.value=!0,y(),z()})}))});const y=()=>{if(f.value=!0,s.value=!0,t.value.nombre==null||t.value.nombre==null||t.value.nombre==""?(b.value.nombre="El nombre es obligatorio",s.value=!1):b.value.nombre="",!s.value){m("error","Verifique los campos marcados en rojo");return}};return{options:q,empleados:v,columns:F,data:t,validate:y,submit:()=>{y();let l={...t.value};if(c.value){var B=t.value.email;w("¿Estás seguro?","Se actualizarán los datos del departamento","warning","Sí, actualizar","No, cancelar").then(k=>{k?n.putDepartamento(l,B).then(i=>{console.log(i),i.status==200?T("¡Éxito!","El departamento se ha actualizado correctamente","success","Aceptar").then(()=>{m("info","Será redirigido a la lista de departamentos"),setTimeout(()=>{u.push({name:"departamentos"})},3e3)}):x("Error",i.response.data.mensaje,"error","Aceptar")}).catch(i=>{m("error","Ocurrió un error al actualizar el departamento")}):m("info","No se actualizaron los datos")})}else w("¿Estás seguro?","Se registrarán los datos del departamento","warning","Sí, registrar","No, cancelar").then(k=>{k?n.postDepartamento(l).then(i=>{i.status==200?T("¡Éxito!","El departamento se ha registrado correctamente","success","Aceptar").then(()=>{u.push({name:"departamento"})}):x("Error",i.response.data.mensaje,"error","Aceptar")}).catch(i=>{m("error","Ocurrió un error al registrar el departamento")}):m("info","No se registraron los datos")})},cancelar:()=>{w("¿Deseas cancelar?","Los cambios no guardados se perderán","question","Sí, cancelar","No, regresar").then(l=>{l&&u.push({name:"departamentos"})})},error:b,validated:f,isEdit:c,eliminar:()=>{D.fire({title:"Se requiere confirmación",text:"Esta acción eliminará al departamento de forma permanente y todos los empleados adscritos se quedarán sin departamento asignado. Esta acción solo la puede realizar el Administrador.",icon:"warning",iconColor:"#dc3545",input:"checkbox",inputValue:0,inputPlaceholder:"Entiendo, quiero continuar",confirmButtonText:'Continuar <i class="bi bi-shield-exclamation"></i>',confirmButtonColor:"#dc3545",cancelButtonText:"Cancelar</i>",showCancelButton:!0,inputValidator:l=>!l&&"Debes confirmar que entiendes las consecuencias de esta acción"}).then(l=>{l.value&&n.deleteDepartamento(t.value.email).then(()=>{D.fire({icon:"success",title:"¡Éxito!",text:"El departamento ha sido eliminado de forma permanente"}).then(()=>{u.push({name:"departamentos"})})}).catch(B=>{m("error","Ocurrió un error al eliminar el departamento")})})},goBack:()=>u.go(-1)}},components:{InputText:U}}),Y={class:"container-lg pt-4 my-3"},Z={class:"card shadow-5 border-round-2xl overflow-hidden"},ee={class:"d-flex relative card-header py-0 pe-0"},ae={class:"flex text-center"},te={key:0,class:"bi bi-person-fill-gear fw-bold h1 my-0"},oe={key:1,class:"bi bi-person-fill-add fw-bold h1 my-0"},se={class:"fw-bold h4 align-self-center ms-3 my-0"},re={id:"form"},ne={class:"card-body"},le={class:"grid"},ie={class:"col-12 md:col-offset-3 md:col-6"},de=e("label",{for:"curp",class:"form-label"},[j("Nombre del departamento"),e("b",{class:"p-error"},"*")],-1),ce={key:0,class:"p-error"},ue=e("small",null,[e("b",{class:"text-danger"},"*"),j(" Campos obligatorios")],-1),me={class:"card-footer d-flex"},pe={class:"card mt-5 border-round-2xl overflow-hidden shadow-5"},he={class:"container table-responsive"},fe={key:0,class:"table table-hover",id:"empleados"},be=e("thead",null,[e("tr",null,[e("th"),e("th",null,"Tarjeta"),e("th",null,"RFC"),e("th",null,"Nombre"),e("th",null,"Estado"),e("th",null,"Edad"),e("th",null,"Nivel académico")])],-1),ve=e("td",null,null,-1);function _e(a,c,E,u,n,f){const s=C("Button"),b=C("InputText"),t=C("Panel");return r(),h("div",Y,[e("div",Z,[e("div",ee,[e("span",ae,[a.isEdit?(r(),h("i",te)):(r(),h("i",oe)),e("span",se,d(a.isEdit?" Editar":"Registrar")+" Departamento ",1)]),_(s,{icon:"pi pi-times",severity:"danger",size:"small",onClick:a.goBack,class:"ms-auto border-noround float-end hover:bg-red-500 hover:text-white",text:"",style:{height:"48px"}},null,8,["onClick"])]),e("form",re,[e("div",ne,[e("div",le,[e("div",ie,[de,_(b,{modelValue:a.data.nombre,"onUpdate:modelValue":c[0]||(c[0]=o=>a.data.nombre=o),placeholder:"Direccion de correo electrónico, ej: nombre@ejemplo.com",class:M(["w-full",{"p-invalid":a.error.nombre&&a.validated}]),id:"nombre",autocomplete:"off",onInput:a.vCurp},null,8,["modelValue","class","onInput"]),a.validated?(r(),h("small",ce,d(a.error.nombre||""),1)):N("",!0)])]),ue]),e("div",me,[a.isEdit?(r(),V(s,{key:0,icon:"pi pi-trash",class:"me-2",label:"Eliminar",onClick:a.eliminar,severity:"danger"},null,8,["onClick"])):N("",!0),_(s,{icon:"pi pi-check",id:"submitButton",class:"me-2 ms-auto",label:"Guardar",onClick:a.submit},null,8,["onClick"]),_(s,{icon:"pi pi-times",class:"ms-2 float-end",severity:"secondary",label:"Cancelar",onClick:a.cancelar},null,8,["onClick"])])])]),e("div",pe,[_(t,{header:"Tabla de empleados",toggleable:""},{default:W(()=>[e("div",he,[a.empleados.length>0?(r(),h("table",fe,[be,e("tbody",null,[(r(!0),h(H,null,J(a.empleados,(o,v)=>(r(),h("tr",{key:v},[ve,e("td",null,d(o.numeroTarjeta),1),e("td",null,d(o.rfc),1),e("td",null,d(o.nombre),1),e("td",null,d(o.estado),1),e("td",null,d(o.edad),1),e("td",null,d(o.nivelAcademico),1)]))),128))])])):N("",!0)])]),_:1})])])}const ge=A(X,[["render",_e]]),Ce={name:"departamentos_editar",components:{DepartamentoForm:ge}};function Ee(a,c,E,u,n,f){const s=C("departamento-form");return r(),V(s,{isEdit:!0})}const xe=A(Ce,[["render",Ee]]);export{xe as default};
